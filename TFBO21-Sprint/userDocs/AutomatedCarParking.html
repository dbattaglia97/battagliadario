
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
	font-size: 93%;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h0, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 90%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	font-size: 90%;
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	font-size: 90%;
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{

    font-size: 18px;
}
k{
    color: #990000;
	font-weight: bold;
	font-size: 90%;
}
h1 {
    font-size: 130%;
    background-color: #b2c0ff;
	padding: 10px;
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #ccffcc;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;

}
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}
div.remark{
	background-color: #E3F2FD;
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed

}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>

<head>

<title>TFBO21ISS</title></head>

<body>

<div class="body">

<h1>Final task ISS-2021 Bologna: Automated Car-Parking</h1>

<div class="body">
		<h2><a name="introduction"></a>Introduction - SPRINT 1</h2>
		<div class="remark">
			<p>In this document it will be analysed the first SPRINT of the project. In order to propose first prototype as soon as possible,
				there will be some simplification compared to original problem.
			</p>
		</div>

<h2>Automated Car-Parking</h2>

A company intends to build an <i>automating parking service</i> composed of a set of elements:

<ul>
<li>A software system, named <em>ParkManagerService</em>, that implements the required automation functions.</li>
<li>A <tt>DDR</tt> robot working as a <em>transport trolley</em>, that is intially situated in its <em>home</em> location.
The <tt>transport trolley</tt> has the form of a square of side length <em>RD</em>.
</li>
<li>A <em>parking-area</em> is an empty room that includes;
	<ul>
	<li>an <em>INDOOR</em> to enter the car in the area. Facing the <tt>INDOOR</tt>, there is
	a <em>INDOOR-area</em> equipped with a <em>weigthsensor</em> that measures the <em>weigth</em> of the car;</li>
	<li>an <em>OUTDOOR</em> to exit from the <tt>parking-area</tt>. Just after the <tt>OUTDOOR</tt>, there is
	<em>OUTDOOR-area</em> equipped with a <em>outsonar</em>, used to detect the presence of a car.
	The <tt>OUTDOOR-area</tt>, once engaded by a car, should be freed within a prefixed interval of time <em>DTFREE</em>; </li>
	<li>a number <tt>N (N=6)</tt> of <em>parking-slots</em>;</li>
	<li>a <em>thermometer</em> that measures the temperature <em>TA</em> of the area;</li>
	<li>a <em>fan</em> that should be activated when <k>TA > TMAX</k>, where <em>TMAX</em> is a prefixed value (e.g. <tt>35</tt>)</li>
	</ul>
	A <em>map</em> of the parking area, represented as a grid of squares of side length <em>RD</em>,
	is available in the file <a href="parkingMap.txt" target="code">parkingMap.txt</a>:
	<pre>
|r, 0, 0, 0, 0, 0, 0, X,
|0, 0, <bc>X, X,</bc>  0, 0, 0, X,
|0, 0, <bc>X, X,</bc>  0, 0, 0, X,
|0, 0, <bc>X, X,</bc>  0, 0, 0, X,
|0, 0, 0, 0, 0, 0, 0, X,
|X, X, X, X, X, X, X, X, </pre>
	The map includes the positions of the  <tt>parking-slots</tt> (marked above with the symbol <k>X</k>)
	and of the <em>fixed obstacles</em> in the area (the walls marked with the symbol <b>X</b>).
	<br/><br/>
	The area marked with <k>X</k> is a sort of 'equipped area' upon which the <tt>transport trolley</tt> cannot walk.
	Thus, to get the car in the <tt>parking-slot</tt> <ks>(2,2)</ks>, the <tt>transport trolley</tt> must
	go in cell <ks>(1,2)</ks>.
	<br/><br/>

	The proper scene for the WEnv is reported in: <a href="parkingAreaConfig.js" target="code">parkingAreaConfig.js</a>


	<center><img src="./img/parkingAreaZone.PNG" alt="parkingAreaZone.PNG" width="45%" height="32%"/></center>
</li>
<li>a <em>parking-manager</em> (an human being) which supervises the state of the <tt>parking-area</tt>
and handles critical situations<!-- by using a software system named <em>ParkMonitoringService</em> -->. </li>
</ul>

<div class="remark">
The job of our company is to design, build and deploy the  <em>ParkManagerService</em>.
</div>
<!-- and the <em>ParkMonitoringService</em>.-->
<h3>User stories</h3>
As a <bc>client - parking phase</bc> :
<ul>
<li>I intend to use a <em>ParkServiceGUI</em> provided by the <tt>ParkManagerService</tt>  to notify my interest in <i>entering</i>
my auto in the <tt>parking-area</tt> and to receive as answer the number <em>SLOTNUM</em> of a  free parking-slot  (<tt>1&lt;=SLOTNUM&lt;=6</tt>).
<tt>SLOTNUM<k>==0</k></tt> means that no free slot is available.</em>

</li>
<li>If <tt>SLOTNUM <k>>0</k></tt>, I move my car in front to the <tt>INDOOR</tt>, get out of the car and afterwards press a <em>CARENTER</em> button on the
<em>ParkServiceGUI</em>. Afterwards, the <tt>transport trolley</tt> takes over my car and moves it from the <tt>INDOOR</tt>
to the selected <tt>parking-slot</tt>.
The <tt>ParkServiceGUI</tt> will show to me a receipt that includes a (unique) <em>TOKENID</em>,
to be used in the <i>car pick up</i> phase.</li>
</ul>

As a <bc>client - car pick up phase</bc> :
<ul>
<li>I intend to use the <tt>ParkServiceGUI</tt> to submit the request to pick up my car, by sending the <tt>TOKENID</tt> previously received. </li>
<li>Afterwards, the <tt>transport trolley</tt>  takes over my car and moves it from its <tt>parking-slot</tt> to the <tt>OUTDOOR-area</tt>.</li>
<li>I move the car, so to free the <tt>OUTDOOR-area</tt>.
</li>
 </ul>

As a <bc>parking-manager</bc>:
<ul>
<li>I intend to use the <em>ParkServiceStatusGUI</em>  provided by the <tt>ParkManagerService</tt>
to observe the <em>current state</em> of the <tt>parking area</tt>, including the value <tt>TA</tt> of the temperature,
the state of the <tt>fan</tt> and the state of the <tt>transport trolley</tt> (<k>idle, working or stopped</k>).</li>
<li>I intend to <em>stop</em> the <tt>transport trolley</tt> when <k>TA > TMAX</k>, activate the <tt>fan</tt> and
wait until <k>TA &lt; TMAX</k>. At this time, I stop the <tt>fan</tt> and resume the behavior of the <tt>transport trolley</tt>.
Hopefully, the <b>start/stop</b> <ks>of the fan</ks> could also be automated by the <tt>ParkManagerService</tt>,
while the <b>start/stop</b> <ks>of the transport trolley</ks> is always up to me.
</li>

<li>I expect that the <tt>ParkManagerService</tt> sends to me an <em>alarm</em> if it detectes that the <tt>OUTDOOR-area</tt>
has not been cleaned within the <tt>DTFREE</tt> interval of time.</li>
</ul>


<h3>Requirements </h3>

The <tt>ParkManagerService</tt>  should create the <tt>ParkServiceGUI</tt> (for the client)
and the <tt>ParkServiceStatusGUI</tt> (for the manager) and then perform the following tasks:


<ul>

<li><hr/>
<em>acceptIN</em>: accept the request of a client to park the car if there is at least one <tt>parking-slot</tt> available,
select a free slot identified with a unique <tt>SLOTNUM</tt>.<br/>
A request of this type can be elaborated only when the <k><tt>INDOOR-area</tt> is free</k>,
and  the <tt>transport trolley</tt> is at <tt>home</tt> or working (<k>not stopped</k> by the manager).
If the <tt>INDOOR-area</tt> is already engaged by a car, the request is not immediately processed
(the client could simply wait or could - optionally - receive a proper notice).
<br/>
  <li><em>informIN</em>: inform the client about the value of the <tt>SLOTNUM</tt>.</li>
If  <k>SLOTNUM>0</k>:
  <ol>
   <li><em>moveToIn</em>: move the <tt>transport trolley</tt> from its current localtion to the <tt>INDOOR</tt> ;</li>
  <li><em>receipt</em>: send to the client a receipt including the value of the <tt>TOKENID</tt> ;</li>
  <li><em>moveToSlotIn</em>: move the <tt>transport trolley</tt> from the <tt>INDOOR</tt> to the selected <tt>parking-slot</tt>;</li>
  <!-- <li>accept another request (<tt>acceptIN</tt> or <tt>acceptOUT</tt>). -->
  <li><em>backToHome</em>: if no other request is present,  move the <tt>transport trolley</tt> to its <tt>home</tt> location,
  else <em>acceptIN</em> or <em>acceptOUT</em>.</li>
  </ol>
 </li>
If <k>SLOTNUM==0</k>:
	<ul>
	<li><em>moveToHome</em>: if not already at home, move the <tt>transport trolley</tt> to its <tt>home</tt> location.</li>
	</ul>
</li>


<li><hr/>
<em>acceptOUT</em>: accept the request of a client to get out the car with <tt>TOKENID</tt>.
A request of this type can be elaborated only when the <k><tt>OUTDOOR-area</tt> is free</k>
and  the <tt>transport trolley</tt> is at <tt>home</tt> or working (<k>not stopped</k> by the manager).
If the <tt>OUTDOOR-area</tt> is still engaged by a car, the request is not immediately processed
(the client could simply wait or could - optionally - receive a proper notice).

	<ol>
	<li><em>findSlot</em>: deduce the number of the parking slot (<em>CARSLOTNUM</em>) from the <tt>TOKENID</tt>;</li>
	<li><em>moveToSlotOut</em>: move the <tt>transport trolley</tt> from its current localtion to the <tt>CARSLOTNUM/parking-slot</tt> ;</li>
	<li><em>moveToOut</em>: move the <tt>transport trolley</tt> to the <tt>OUTDOOR</tt> ;</li>
	<li><em>moveToHome</em>: if no other request is present  move the <tt>transport trolley</tt> to its <tt>home</tt> location; <br/>
	else <em>acceptIN</em> or <em>acceptOUT</em></li>

	</ol>
</li>
<li>
<hr/>
<em>monitor</em>: update the <tt>ParkServiceStatusGUI</tt> with the required information about the state of the system.
</li>

<li>
<hr/>
<em>manage</em>: accept the request of the manager to stop/resume the behavior of the  <tt>transport trolley</tt>.
</li>

</ul>
<h4>About the devices</h4>
All the sensors (<tt>weigthsensor</tt>, <tt>outsonar</tt>, <tt>thermometer</tt> ) and the <tt>fan</tt> should be properly simulated
by mock-objects or mock-actors.

<h4>When using a real robot</h4>
No further requirement.

<h4>When available a Raspberry and a sonar</h4>
The <tt>outsonar</tt> could be a real device. We can simulate the presence/absence of a car.

    <h4>When using <k>only</k> the virtual robot or <k>no real sonar</k> available</h4>
Consider the new requirement:
<ul>
<li><ks>authorize</ks>: allow a manager to use the <tt>ParkServiceStatusGUI</tt> only if she/he owns <bc>proper permissions</bc>.</li>

</ul>




<h2>Requirement analysis</h2>
<div class="remark">
<h3>Glossary</h3>
  	<p>The following definitions are clarified:</p>
  			<ul>
  				<li>
  					<ks>WeightSensor: </ks> device that provides weight of a car located in the
  					INDOOR-area.
  				</li>
          <li>
  					<ks>Parking-area</ks>: rectangular empty room where the robot can move and the cars can park. This area is surrounded by walls, except for an entrance and an exit .
  				</li>
          <li>
  					<ks>INDOOR-area</ks>: area designed for the entrance of the car in the parking area. In this area cars wait for the trolley pick up. This area is equipped with a weight sonar.
  				</li>

          <li>
  					<ks>OUTDOOR-area</ks>: area where the trolley carriesa car in order to be picked up by his owner. It is equipped with an outsonar, which detects if this area is cleared by the user within the time DTFREE.
  				</li>
          <li>
            <ks>Parking slots</ks>: places where cars can be parked. The transport trolley cannot transit on these slots.
          </li>
  				<li>
  					<ks>OutSonar: </ks>is a sensor that provide a signal if a car is located in the OUTDOOR-area.
  					Initially this sensor has the purpose of signaling the presence of a car in the OUTDOOR-area.
  					This component can be equipped with an internal timer, that signals if a car remains in the OUTDOOR-area
  					longer than a certain threshold, in this case it will be sended an alarm to the Parking-manager
  				</li>
  				<li>
  					<ks>Thermometer: </ks> is a sensor that measures temperature of the environment.
  				</li>
          <li>
  					<ks>Fan: </ks> device capable of reducing the temperature of the parking area.
  				</li>
          <li>
  					<ks>Parking-manager: </ks>human being which supervises the state of the parking-area and handles critical situations.
  				</li>
  				<li>
  					<ks>ParkServiceGUI: </ks>this is the GUI associated with Clients. It allows clients to request access to the
  					car park and to park their car. Through this GUI clients can receive, from the system, some informations, that are necessary for
  					parking operations, such as the parking-slot assigned to them and the corresponding TOKENID.
  					This GUI permits the clients to make request to pickup their car, providing their TOKENID.
  				</li>
  				<li>
  					<ks>ParkServiceStatusGUI: </ks>this is the GUI associated with ParkingManager. It provides all the
  					tools concerning parking area management and various information on the status of the parking area and its components.
  				</li>
  				<li>
  					<ks>Transport Trolley: </ks> is a DDR robot that has the task of moving cars from INDOOR to an
  					assigned park-slot and, on a withdraw request, of moving cars from park-slot to OUTDOOR.
            While the car is on the robot, they fill the same space on the map.
  					Trolley have three operative state: <k>idle</k>, <k>working</k>, <k>stopped</k>.
  					<ul>
  						<li>
  							When he is in <k>idle</k> state, means that he don't has any request to serve. In this case
  							he returns to his main place (<k>HOME</k>).
  						</li>
  						<li>
  							When he is in <k>working</k> state, means that he has to serve (or is serving) a request.
  						</li>
  						<li>
  							When he is in <k>stopped</k> state, means that there are some problems in the environment
  							and the <ks>Parking Manager</ks> has manually stopped the trolley.
  							When he is in this situation, Trolley immediately stops whatever type of work it is doing
  							and stays where he is.
  						</li>
  					</ul>
  				</li>
  				<li>
  					<ks>Home: </ks> location where the robot stands when the robot status is IDLE, it is situated in the north-west corner of room,
  					coordinates (0,0), facing south.
  				</li>
  				<li>
  					<ks>TOKENID: </ks> is  an identification number of a parking operation, strictly
  					associated with the client owner of the parked car and a slot.
  					This number will be used when the client decides to pickup his car from the parking-area.
  				</li>
<hr />
          Regarding actions (verbs):
            <ul>
            <li><ks>stop (of the robot)</ks>: when the temperature detected by thermometer is higher then TMAX, the parking manager disables robot operations. If the robot was moving, it will have to stop immediately. </li>
            <li><ks>start (of the fan)</ks>: when the robot has stopped, the parking manager must turn on the fan.  </li>
            <li><ks>stop (of the fan)</ks>: when the temperature detected by thermometer is lower then TMAX, the parking manager can turn off the fan.  </li>
            <li><ks>start (of the robot)</ks>: when the temperature detected by thermometer is lower then TMAX and the fan is turned off, the parking manager can turn on the robot.  </li>
            </ul>
</ul>

    <h3> Components Analysis </h3>
          <ul>
  				<li>
  					<k>trolley:</k> is a virtual robot that can move in the virtual environment <a href="http://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2021/main/it.unibo.virtualRobot2020/userDocs/VirtualRobot2021.html">WEnv</a> provided by the customer.
  				<li>
  					<k>map:</k> is a representation of the parking-area map. The customer provided a map of the parking-area in a textual format and as JavaScript configuration file compatible with the Wenv.
          <li>
  					<k>weightsensor:</k> is a component that is not provided by the customer, so it will be simulated by mock-objects or mock-actors.
  				<li>
  					<k>outsonar: </k> is a component that may be simulated by mock-objects or mock-actors or implemented by a C library
  					called <ks>SonarAlone.c</ks> provided by customer and handled by a kotlin class called <ks>
  						sonarHCSR04Support2021.kt</ks>
  				<li>
  					<k>thermometer:</k> it's not provided by the customer, so it will be a simulated sensor of temperature, properly simulated by mock-objects or mock-actors..
  				<li>
  					<k>fan:</k> is a component that simulates the operation of a fan, i.e. it reduces the temperature	of the room when it is activate. The fan should be a passive component able to start and stop the device when notified
            <li>
    					<k>ParkServiceGUI and ParkServiceStatusGUI:</k> The ParkServiceGUI (used by clients) and the ParkServiceStatusGUI (used by the parking-manager) must be provided by our ParkManagerService. The customer has intended that the two GUIs are likely best to be designed as Web GUIs.
            </ul>




</div>

<h2>Problem analysis</h2>
<div class="remark">
  <p>As mentioned in the <a href="#introduction">Introduction</a> for the first SPRINT, in this document we
  				will analyze a simplified verision of the problem .</p>
  				<h3>Assumptions</h3>
          <ul>
  				<li><k>GUIs not implemented</k> (neither for the client nor for the parking-manager);
  				<li>Actions of <k>Parking-Manager</k> will not be performed because the manager performs its actions through the GUI, which is not available
  				<li><k>No thermometer and fan</k> .
  				<li><k>Clients</k> will withdraw their car in time, before the alarm activation.
  				<li><k>No Trolley</k> no commands are sent to the Trolley, and no real movements are performed by it.The actions will be simulated considering a waiting time.
          </ul>
        <h3>Relevant aspects</h3>
          <ol>
            <li>The system to be built will be a distributed system, made of several heterogeneous components, would benefit greatly from an <k>actor-based</k> framework with support for <k>message-passing</k> interaction; for this purpose, we should leverage the available <a href="http://htmlpreview.github.io/?https://raw.githubusercontent.com/anatali/issLab2021/main/it.unibo.qakactor/userDocs/LabQakIntro2021.html#qakoverview">QAK meta-model</a> to build executable models;</li>
          	<li>There isn't any conceptual abstraction gap for this problem, however since we proposed to exploit the <k>QAK meta-model</k>, we are put in front of an <k>abstraction gap</k> regarding the use of languages because QAK relies on Java and Kotlin to work. However, QAK itself manages to fill a large part of this limitation, as it is supplied with its own domain specific language and because it was designed specifically for heterogeneous distributed systems;</li>
          	<li>The <k>QAK meta-model</k> provides compatibility with the communication protocols <ks>TCP</ks>, <ks>MQTT</ks> and <ks>CoAP</ks>, equally valid for the interaction between actors; regarding the communication with the <k>WEnv</k> (or other compatible trolleys), both supported interaction models (<ks>HTTP POST</ks> and <ks>WebSocket</ks>) are fit for the task.</li>
          </ol>

        <h3>Logical architecture</h3>
            <p>Our system in the first sprint it's composed by four QActor:
              <li>parkingmanagerservice</li>
              <li>client</li>
              <li>weightsensor</li>
              <li>outsonar</li>
            </p>
        <p>
				<table style="width:100%" border="1">

						<td>
							<center><ks>parkingmanagerservice: </ks></center>
							<center> <a href="../src/sprint1.qak">sprint1.qak: </a></center><br>
							This QActor handles all client's request: <tt>reqenter</tt>, <tt>carenter</tt> and <tt>pickup</tt> providing the clients the SLOTNUM and the TICKETID. It coordinates the movements of the trolley
							(in this version they are only simulated with delays). It has to notify to the <tt>weightsensor</tt> and <tt>outsonar</tt> when a car is, respectively, in INDOOR and OUTDOOR area. In order to do this it emits <k>events</k> and it don't send <k>dispatch</k>, since in the QActor metamodel an event is intended as information emitted by some source without any explicit destination and this suits better out scope.
						<td>
							<center><ks>parkingservicegui (client simulation): </ks></center>
							<center> <a href="../src/sprint1.qak">sprint1.qak: </a></center><br>
							It's the QActor that simulates the behaviour of a client because <ks>ParkServiceGUI</ks> is not yet implemented. It sends the requests <tt>reqenter</tt> and <tt>carenter</tt> to the system during the parking phase and the request <tt>pickup</tt> during the picking phase.<br>
						</td>
					</tr>
					<tr>
						<td>
							<center><ks>weightsensor: </ks></center>
							<center> <a href="../src/sprint1.qak">sprint1.qak: </a></center><br>
							This mock-actor generates a random value that represents the
									weight of car in entrance and propagates it by emitting an event <tt>weight</tt>.<br>
									It starts the simulation when perceives the <k>carindoorarrival</k> event.
									<br>
									The purpose of this component is to ensure that a car in actual in INDOOR-area when a client press the
									<tt>carenter</tt> button.
						</td>
						<td>
							<center><ks>outsonar: </ks></center>
							<center> <a href="../src/sprint1.qak">sprint1.qak: </a></center><br>
							It starts its work when perceives <k>caroutdoorarrival</k> event. After that if it detects the <k>carwithdrawn</k> event, indicating that the car has been taken out of the OUTDOOR-area, the timer stops but if it reaches <tt>DTFREE</tt> value it emits an event <tt>timeout</tt>.
						</td>
					</tr>
					<tr>
						<td colspan="2">
							<center><img src="img/logicalArchitecture.png" width="60%"></center>
						</td>
					</tr>
				</table>
			</p>





<h3>Model - SPRINT 2</h3>
				<center>
					<ks><a href="../src/parkingservice.qak">parkingmanagerservice.qak</a></ks>
				</center>
				<br>
				<table style="width:100%; border:1px solid; font-family: Consolas; background-color:#f5f5f5;">
					<tr>
						<td>
							<center>
								<ks>parkingmanagerservice</ks>
							</center>
						</td>
						<td>
							<center>
								<ks>parkingservicegui</ks>
							</center>
						</td>
					</tr>
					<tr>
						<td colspan=2>
							<center>
								<bc>Parking Phase</bc>
							</center>
						</td>
					</tr>
					<tr>
						<td style="width:50%">
							<br>
							<ul style="font-family: Consolas; font-size: 15px">
								<li>It checks if <em>INDOOR</em> is free and if there is at least one
									<tt>parking-slot</tt>	available

								<li>It's received the request <tt>reqenter</tt> sended by a <b>client</b>.</li>

								<li><ks>[acceptIN]</ks> It's retrieved the <em>SLOTNUM</em> of the free parking slot.

								<li><ks>[informIN]</ks><b> parkingmanagerservive</b> sends the reply
									<tt>slotsnum(SLOTNUM)</tt> to the <b>client</b>.

								<li><ks>[moveToIn]</ks> it's simulated the movements of <b>Trolley</b>
									from his current position to <em>INDOOR</em>

                  <li>It's received the request <tt>carenter</tt> sended by the <b>client</b>.

								<li><b>parkingmanagerservive</b> emits an event <tt>carindoorarrival</tt>, to notify to the <b>weightsensor</b>
									that the client's car is in <em>INDOOR-area</em>.
								<li>The <b>weightsensor</b> perceives <tt>carindoorarrival</tt> and emit the event
									<tt>weight(CARWEIGHT)</tt>.
								<li><em>INDOOR</em> is marked as occupied
								<li>
									<ks>[moveToSlotIn]</ks> If the weight obtained from <b>weightsensor</b> notifies the
									effective presence of a car in <em>INDOOR-area</em>,
									<b>Trolley</b> takes the car and moves it to slot assigned to it (SIMULATED) and the <em>parking slot</em> is marked as occupied.
								<li><em>INDOOR</em> is marked as free.
								<li>
									<ks>[receipt]</ks> Generation of the <em>TOKENID</em> related to <em>SLOTNUM</em>
									assigned to <b>client</b> and reply to him
									with <tt>receipt(TOKENID)</tt>.
								<li>
							</ul>
						<td>
							<ul style="font-family: Consolas; font-size: 15px">
								<li><b>client</b> sends a request <tt>reqenter</tt> to notify his interest in
									entering his car in the <em>parking-area</em>.
								<li>If the request is replied, <b>client</b> moves the car in front of <em>INDOOR</em>,
									(press the <em>CARENTER</em> button) and send the request <tt>carenter</tt> to <b>parkingmanagerservive</b>, otherwise
									his request is queued.
							</ul>
						</td>
					<tr>
						<td colspan=2>
							<center>
								<bc>Car pick up phase</bc>
							</center>
						</td>
					</tr>
					<tr>
						<td>
							<ul style="font-family: Consolas; font-size: 15px">
								<li>It checks if <em>OUTDOOR</em> is free.
								<li>
									<ks>[acceptOUT]</ks> It's received the request <tt>pickup(TOKENID)</tt> sended by a
									<b>client</b>.
								<li>
									<ks>[findSlot]</ks> It's obtained the <em>CARSLOTNUM</em> from <tt>TOKENID</tt>
									sended
									by <b>client</b>.
								<li>
									<ks>[moveToSlotOut]</ks> it's simulated  the movements of
									<b>Trolley</b>
									from his current position to <em>CARSLOTNUM</em>.
								<li>
									<ks>[moveToOut]</ks> it's simulated the movements of <b>Trolley</b> to
									<em>OUTDOOR</em>
								<li><em>OUTDOOR</em> is marked as occupied.
								<li>The slot corrisponding to <em>CARSLOTNUM</em> is marked as free and the relative TOKEN is removed.
								<li><b>parkingmanagerservice</b> emits an event <tt>caroutdoorarrival</tt>.
								<li>The <b>ousonar</b> perceives <tt>caroutdoorarrival</tt> and starts its timer.
								<li>Timer of <b>outsonar</b> will be cancelled when the <b>client</b> emits the event
									<tt>carwithdrawn</tt>, if this event isn't emitted within <tt>DTFREE</tt>,  <b>outsonar</b> emit an event
  									<tt>timeout</tt> (which is not yet handled).
								<li><em>OUTDOOR</em> is marked as free.
							</ul>
						</td>
						<td>
							<ul style="font-family: Consolas; font-size: 15px">
								<li><b>client</b> send a request to <b>parkingmanagerservice</b>
									<tt>pickup(TOKENID)</tt> to notify his interest in picking his car from parking-area.

                  <li>The <b>client</b> waits for the acceptance of the request and wait for the car to be in the <em>OUTDOOR-area</em>,

								<li>When the car is in <em>OUTDOOR-area</em>, the <b>client</b> takes his car away, then
									emit an event <tt>carwithdrawn</tt>.
							</ul>
						</td>
					</tr>
					<tr>
						<td colspan=2>
							<center>
								<bc>Parking-manager</bc>
							</center>
						</td>
					</tr>
					<tr>
						<td colspan=2>
							<ul style="font-family: Consolas; font-size: 15px">
								<li>The features related to the <tt>parking manager</tt> and its GUI are not considered
									for
									the time being.
									Consequently, neither the thermometer or the fans are considered.
								<li>Any alarm (timeout) emitted by the <b>outsensor</b> is not managed.
							</ul>
						</td>

					</tr>
				</table>

        <h4>ParkingAreaKb</h4>
      				<p>
                This knowledge base is written in prolog and it is used to
                <li>Check and changes of the system status: parking slots, indoor and outdoor areas</li>
      					<li>TokenID management</li>

      					A possible way of implementing this knowledge base can be seen in the file <a
      						href="..\ParkingAreaKb.pl">ParkingAreaKb.pl</a>.
      	</p>

        <h4>TokenID handling</h4>
  				<p>By requirements it's necessary to generate a UNIQUE TokenID that is uniquely linked to <tt>SLOTNUM</tt>.
  					The <tt>TOKENID</tt> is a code composed by two parts: the first one is relative to a progressive number which increases every time it is accepted a <tt>reqenter</tt> request and the second one is relative to the <tt>SLOTNUM</tt>. So, in order to extract the <tt>SLOTNUM</tt> from the <tt>TOKENID</tt>, we have to extract the last digit.
  				</p>
  				<p>
            The generated tokens are added to the knowledge base, in order to check if the inserted token during the pickup phase is wrong or not.
  					While when a car is picked by a <b>client</b> his related <tt>TOKENID</tt> is deleted from this knowledge base.
  				</p>
</div>
</div>
<h2>Test plans</h2>
<div class="remark">
<ks>MAIN GOALS</ks>:
<ol>
<li>with reference to the <k>logical architecture</k> of the system,
write a program (e.g. by using <ks>JUnit</ks>) that defines the set of <k>functional TestPlans</k> that the software must satisfy.
</li>

</ol>

</div>

<h2>Project</h2>
<div class="remark">
<ks>MAIN GOALS</ks>:
<ol>
<li>by starting from the <k>logical architecture</k> of the system,
define the <k>concrete/k> architecture of the system and the behavior of each component  .</li>
</ol>
</div>

<h2>Testing</h2>
<div class="remark">
<ks>MAIN GOALS</ks>:
<ol>
<li>complete the <k>functional TestPlans</k> according to the project code and execute them.</li>
</ol>

</div>

<h2>Deployment</h2>
<div class="remark">
<ks>MAIN GOALS</ks>:
<ol>
<li> prepare the  software application to run and operate in a specific environment.</li>
</ol>
 </div>
It involves installation, configuration, testing and making changes to optimize the performance of the software.
It can either be carried out manually or (hopefully) through automated systems.




<h2>Maintenance</h2>
<div class="remark">
<ks>MAIN GOALS</ks>:
<ol>
<li>modify the software product after delivery to correct faults,
to improve performance or other attributes. </li>
</ol>
 </div>
A common perception of maintenance is that it merely involves fixing defects.
However, one study indicated that over <tt>80%</tt> of maintenance effort is used for non-corrective actions.


<!--
See <a href="https://phoenixnap.com/kb/how-to-commit-changes-to-docker-image" target="web">How to Commit Changes to a Docker Image</a>
and <a href="../../it.unibo.virtualrobotcontrol/userDocs/VirtualrobotControl.html" target="lab">LabIss2021 | A web-gui for virtual robot control</a>
<pre>

docker build -t virtualrobotparking:1.0 .



docker run -ti -p 8090:8090 -p 8091:8091 --rm natbodocker/virtualrobotdisi:2.0 /bin/sh  <kc>//to change WEnv/WebGLScene/sceneConfig</kc>

cd /home/node/WEnv/WebGLScene
nano

sudo docker commit [CONTAINER_ID] [new_image_name]

</pre>
-->
</li>
</ul>
 <!--
 // https://mvnrepository.com/artifact/it.unibo.alice.tuprolog/2p-core
compile group: 'it.unibo.alice.tuprolog', name: '2p-core', version: '4.1.1'
 -->
 <table style="width:100%" border="1">
 <tr>
 <td style="width:50%">
 </td>
 <td></td>
 </tr>
 </table>

 <br/><br/>
 </div>
 <div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
 By Dario Battaglia email: dario.battaglia2@studio.unibo.it
 <img src="./img/darioBattaglia.jpg" alt="mbot" width="15%" height="15%">
 </div>
 </body>
 </html>
